import{a as pe}from"./chunk-Y5JPPF4C.js";import{c as de}from"./chunk-WXOXMQ3X.js";import{$ as oe,Aa as le,Da as ce,Fa as se,L as ie,a as ee,ma as ae,o as ne,s as te,xa as re}from"./chunk-TI2PQS3J.js";import"./chunk-JQ3F7U5Y.js";import{$a as K,A as _,Aa as B,B as n,C as t,D as c,E as F,F as h,Fa as D,G as g,Ga as q,Ha as R,Ia as $,Ja as L,K as o,Ka as H,L as d,M as k,Ma as V,N as P,Oa as G,R as N,Sa as J,T,V as j,Z as A,ab as Q,bb as U,eb as W,ia as w,ib as X,j as v,jb as Y,k as O,l as z,m as S,o as a,r as p,s as y,sb as Z,t as x,u as C,w as m,x as E,y as I,z as u}from"./chunk-IBAPA63D.js";import"./chunk-XMAMLXFW.js";import"./chunk-EW67HA6M.js";import"./chunk-WXVXXLBH.js";import"./chunk-EFAAWUSX.js";import"./chunk-GLOUZK3F.js";import"./chunk-N4PXAYQ7.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-NMPY7VJP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as b}from"./chunk-B4AJQJMI.js";var me=(i,l)=>l.nivel;function ge(i,l){i&1&&(n(0,"div",3),c(1,"ion-spinner"),t())}function ue(i,l){if(i&1&&(n(0,"div",11),c(1,"ion-progress-bar",28),n(2,"p"),o(3),t()()),i&2){let e=g(2);a(),y("value",e.progresoNivel),a(2),P("",e.puntosParaSiguiente," puntos para ",e.siguienteNivel.nombre,"")}}function _e(i,l){if(i&1&&(n(0,"div",14),c(1,"ion-icon",29),n(2,"span"),o(3),t()()),i&2){let e=l.$implicit;a(3),d(e)}}function fe(i,l){i&1&&c(0,"ion-icon",6)}function ve(i,l){i&1&&c(0,"ion-icon",33)}function xe(i,l){i&1&&(n(0,"ion-badge",37),o(1,"Actual"),t())}function Ce(i,l){if(i&1&&(n(0,"div",30)(1,"div",31)(2,"div",32),p(3,fe,1,0,"ion-icon",6)(4,ve,1,0,"ion-icon",33),t(),n(5,"div",34)(6,"span",35),o(7),t(),n(8,"span",36),o(9),t()()(),p(10,xe,2,0,"ion-badge",37),t()),i&2){let e=l.$implicit,r=g(2);C("activo",r.esNivelActual(e))("desbloqueado",r.esNivelDesbloqueado(e)),a(2),x("background",e.color),a(),m(r.esNivelDesbloqueado(e)?3:4),a(4),d(e.nombre),a(2),k("",e.puntosMinimos," puntos"),a(),m(r.esNivelActual(e)?10:-1)}}function he(i,l){i&1&&(n(0,"p",18),o(1,"A\xFAn no tienes movimientos"),t())}function Pe(i,l){if(i&1&&(n(0,"div",38)(1,"div",39)(2,"span",40),o(3),t(),n(4,"span",41),o(5),T(6,"date"),t()(),n(7,"span",42),o(8),t()()),i&2){let e=l.$implicit;a(3),d(e.descripcion),a(2),d(j(6,8,e.fecha,"dd/MM/yyyy")),a(2),C("positivo",e.tipo==="ganado")("negativo",e.tipo==="canjeado"),a(),P(" ",e.tipo==="ganado"?"+":"-","",e.cantidad," ")}}function Me(i,l){if(i&1&&u(0,Pe,9,11,"div",38,E),i&2){let e=g(2);_(e.historial)}}function be(i,l){if(i&1){let e=F();n(0,"div",4)(1,"div",5),c(2,"ion-icon",6),n(3,"span",7),o(4),t()(),n(5,"div",8)(6,"span",9),o(7),t(),n(8,"span",10),o(9,"puntos"),t()(),p(10,ue,4,3,"div",11),t(),n(11,"ion-card",12)(12,"ion-card-header")(13,"ion-card-title"),c(14,"ion-icon",13),o(15," Tus Beneficios "),t()(),n(16,"ion-card-content"),u(17,_e,4,1,"div",14,I),t()(),n(19,"ion-card")(20,"ion-card-header")(21,"ion-card-title"),c(22,"ion-icon",15),o(23," Niveles del Programa "),t()(),n(24,"ion-card-content"),u(25,Ce,11,10,"div",16,me),t()(),n(27,"ion-card")(28,"ion-card-header")(29,"ion-card-title"),c(30,"ion-icon",17),o(31," Historial Reciente "),t()(),n(32,"ion-card-content"),p(33,he,2,0,"p",18)(34,Me,2,0),t()(),n(35,"ion-card")(36,"ion-card-header")(37,"ion-card-title"),c(38,"ion-icon",19),o(39," \xBFC\xF3mo ganar puntos? "),t()(),n(40,"ion-card-content")(41,"div",20)(42,"span",21),o(43,"Por cada $10 en servicios"),t(),n(44,"span",22),o(45,"+1 pt"),t()(),n(46,"div",20)(47,"span",21),o(48,"Dejar una rese\xF1a completa"),t(),n(49,"span",22),o(50,"+5 pts"),t()(),n(51,"div",20)(52,"span",21),o(53,"Referir a un amigo"),t(),n(54,"span",22),o(55,"+50 pts"),t()(),n(56,"div",20)(57,"span",21),o(58,"Completar tu perfil"),t(),n(59,"span",22),o(60,"+20 pts"),t()(),n(61,"div",23)(62,"p")(63,"strong"),o(64,"100 puntos = $10 de descuento"),t()(),n(65,"p",24),o(66,"Canjea tus puntos en tu pr\xF3ximo servicio"),t()()()(),n(67,"div",25)(68,"ion-button",26),h("click",function(){z(e);let s=g();return S(s.verBeneficios())}),c(69,"ion-icon",27),o(70," Canjear Beneficios "),t()()}if(i&2){let e=g();x("background",e.obtenerGradiente()),a(4),d(e.obtenerNombreNivel()),a(3),d(e.fidelizacion.puntos),a(3),m(e.siguienteNivel?10:-1),a(7),_(e.beneficiosActuales),a(8),_(e.niveles),a(8),m(e.historial.length===0?33:34)}}var Le=(()=>{class i{constructor(){this.router=v(w),this.fidelizacionServicio=v(pe),this.fidelizacion=null,this.niveles=de,this.historial=[],this.cargando=!1,ee({ribbonOutline:ae,giftOutline:ie,starOutline:le,trophyOutline:se,chevronForward:te,checkmarkCircle:ne,lockClosed:oe,sparkles:re,timeOutline:ce})}ngOnInit(){this.cargarDatos()}cargarDatos(){this.cargando=!0,this.fidelizacionServicio.obtenerMiFidelizacion().subscribe({next:e=>{this.cargando=!1,e.datos&&(this.fidelizacion=e.datos,this.historial=e.datos.historialPuntos?.slice(0,5)||[])},error:()=>{this.cargando=!1}})}refrescar(e){return b(this,null,function*(){yield this.cargarDatos(),e.target.complete()})}get nivelActual(){return this.niveles.find(e=>e.nivel===this.fidelizacion?.nivel)}get siguienteNivel(){let e=this.niveles.findIndex(r=>r.nivel===this.fidelizacion?.nivel);return e<this.niveles.length-1?this.niveles[e+1]:void 0}get progresoNivel(){if(!this.siguienteNivel||!this.nivelActual)return 1;let e=this.fidelizacion.puntos-this.nivelActual.puntosMinimos,r=this.siguienteNivel.puntosMinimos-this.nivelActual.puntosMinimos;return e/r}get puntosParaSiguiente(){return this.siguienteNivel?this.siguienteNivel.puntosMinimos-this.fidelizacion.puntos:0}get beneficiosActuales(){return this.nivelActual?.beneficios||[]}obtenerNombreNivel(){return this.nivelActual?.nombre||"Bronce"}obtenerGradiente(){let e=this.nivelActual?.color||"#CD7F32";return`linear-gradient(135deg, ${e}, ${this.ajustarColor(e,-30)})`}esNivelActual(e){return e.nivel===this.fidelizacion?.nivel}esNivelDesbloqueado(e){return this.fidelizacion?.puntos>=e.puntosMinimos}verBeneficios(){this.router.navigate(["/beneficios"])}ajustarColor(e,r){let s=parseInt(e.replace("#",""),16),M=Math.max(0,Math.min(255,(s>>16)+r)),f=Math.max(0,Math.min(255,(s>>8&255)+r));return"#"+(Math.max(0,Math.min(255,(s&255)+r))|f<<8|M<<16).toString(16).padStart(6,"0")}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=O({type:i,selectors:[["app-fidelizacion"]],standalone:!0,features:[N],decls:11,vars:1,consts:[["slot","start"],["defaultHref","/tabs/perfil","text",""],["slot","fixed",3,"ionRefresh"],[1,"loading-container"],[1,"nivel-card"],[1,"nivel-header"],["name","ribbon-outline"],[1,"nivel-nombre"],[1,"puntos"],[1,"numero"],[1,"etiqueta"],[1,"progreso-nivel"],[1,"tarjeta-beneficios"],["name","gift-outline"],[1,"beneficio-item"],["name","trophy-outline"],[1,"nivel-item",3,"activo","desbloqueado"],["name","time-outline"],[1,"sin-historial"],["name","sparkles"],[1,"ganar-item"],[1,"accion"],[1,"puntos-ganar"],[1,"ganar-info"],[1,"info-detalle"],[1,"ion-padding"],["expand","block",3,"click"],["name","gift-outline","slot","start"],[3,"value"],["name","checkmark-circle","color","success"],[1,"nivel-item"],[1,"nivel-info"],[1,"nivel-icono"],["name","lock-closed"],[1,"nivel-datos"],[1,"nombre"],[1,"puntos-requeridos"],["color","primary"],[1,"historial-item"],[1,"historial-info"],[1,"concepto"],[1,"fecha"],[1,"historial-puntos"]],template:function(r,s){r&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),c(3,"ion-back-button",1),t(),n(4,"ion-title"),o(5,"Programa de Fidelizaci\xF3n"),t()()(),n(6,"ion-content")(7,"ion-refresher",2),h("ionRefresh",function(f){return s.refrescar(f)}),c(8,"ion-refresher-content"),t(),p(9,ge,2,0,"div",3)(10,be,71,6),t()),r&2&&(a(9),m(s.cargando?9:s.fidelizacion?10:-1))},dependencies:[G,J,Y,X,$,L,H,V,Z,q,D,K,W,Q,U,R,B,A],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:64px}.nivel-card[_ngcontent-%COMP%]{margin:16px;padding:24px;border-radius:16px;color:#fff;text-align:center}.nivel-card[_ngcontent-%COMP%]   .nivel-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:16px}.nivel-card[_ngcontent-%COMP%]   .nivel-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.nivel-card[_ngcontent-%COMP%]   .nivel-header[_ngcontent-%COMP%]   .nivel-nombre[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.nivel-card[_ngcontent-%COMP%]   .puntos[_ngcontent-%COMP%]   .numero[_ngcontent-%COMP%]{font-size:48px;font-weight:800;display:block}.nivel-card[_ngcontent-%COMP%]   .puntos[_ngcontent-%COMP%]   .etiqueta[_ngcontent-%COMP%]{font-size:16px;opacity:.9}.nivel-card[_ngcontent-%COMP%]   .progreso-nivel[_ngcontent-%COMP%]{margin-top:20px}.nivel-card[_ngcontent-%COMP%]   .progreso-nivel[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .3);--progress-background: white;height:8px;border-radius:4px}.nivel-card[_ngcontent-%COMP%]   .progreso-nivel[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0 0;font-size:13px;opacity:.9}ion-card[_ngcontent-%COMP%]{margin:16px;border-radius:12px}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:18px}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.tarjeta-beneficios[_ngcontent-%COMP%]   .beneficio-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--ion-color-light)}.tarjeta-beneficios[_ngcontent-%COMP%]   .beneficio-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.tarjeta-beneficios[_ngcontent-%COMP%]   .beneficio-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.tarjeta-beneficios[_ngcontent-%COMP%]   .beneficio-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.nivel-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 0;border-bottom:1px solid var(--ion-color-light);opacity:.5}.nivel-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.nivel-item.desbloqueado[_ngcontent-%COMP%]{opacity:1}.nivel-item.activo[_ngcontent-%COMP%]{opacity:1;background:var(--ion-color-primary-tint);margin:0 -16px;padding:16px;border-radius:8px}.nivel-item[_ngcontent-%COMP%]   .nivel-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.nivel-item[_ngcontent-%COMP%]   .nivel-icono[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center}.nivel-item[_ngcontent-%COMP%]   .nivel-icono[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#fff}.nivel-item[_ngcontent-%COMP%]   .nivel-datos[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:14px}.nivel-item[_ngcontent-%COMP%]   .nivel-datos[_ngcontent-%COMP%]   .puntos-requeridos[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium)}.sin-historial[_ngcontent-%COMP%]{text-align:center;color:var(--ion-color-medium);padding:16px}.historial-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--ion-color-light)}.historial-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.historial-item[_ngcontent-%COMP%]   .historial-info[_ngcontent-%COMP%]   .concepto[_ngcontent-%COMP%]{display:block;font-size:14px}.historial-item[_ngcontent-%COMP%]   .historial-info[_ngcontent-%COMP%]   .fecha[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium)}.historial-item[_ngcontent-%COMP%]   .historial-puntos[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.historial-item[_ngcontent-%COMP%]   .historial-puntos.positivo[_ngcontent-%COMP%]{color:var(--ion-color-success)}.historial-item[_ngcontent-%COMP%]   .historial-puntos.negativo[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.ganar-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--ion-color-light)}.ganar-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.ganar-item[_ngcontent-%COMP%]   .accion[_ngcontent-%COMP%]{font-size:14px}.ganar-item[_ngcontent-%COMP%]   .puntos-ganar[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-primary)}.ganar-info[_ngcontent-%COMP%]{margin-top:16px;padding:16px;background:var(--ion-color-primary);border-radius:8px;text-align:center}.ganar-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;color:#fff}.ganar-info[_ngcontent-%COMP%]   .info-detalle[_ngcontent-%COMP%]{margin-top:4px;font-size:13px;opacity:.8}"]})}}return i})();export{Le as FidelizacionPage};
