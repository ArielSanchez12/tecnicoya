import{Aa as de,C as oe,Da as pe,Fa as _e,_ as re,a as te,ka as ce,l as ne,ma as le,na as se,o as ie,u as ae,ua as me}from"./chunk-TI2PQS3J.js";import{a as ee}from"./chunk-XRERQNEZ.js";import{a as Z}from"./chunk-JQ3F7U5Y.js";import{A as O,Aa as j,B as n,C as a,D as s,E as v,F as y,Fa as $,G as m,Ga as D,Ha as z,Ia as U,Ja as V,K as c,Ka as R,L as S,M as b,Ma as B,Oa as H,R as T,Sa as L,Ua as N,Ya as q,Za as G,ca as A,e as g,eb as J,i as k,ia as F,ib as K,j as _,jb as Q,k as w,l as x,m as M,o as r,ob as W,qb as X,r as d,s as C,sb as Y,u as I,v as P,w as p,y as E,z as h}from"./chunk-IBAPA63D.js";import"./chunk-XMAMLXFW.js";import"./chunk-EW67HA6M.js";import"./chunk-WXVXXLBH.js";import"./chunk-EFAAWUSX.js";import"./chunk-GLOUZK3F.js";import"./chunk-N4PXAYQ7.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-NMPY7VJP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as u}from"./chunk-B4AJQJMI.js";var ue=(()=>{class t{constructor(){this.apiUrl=`${Z.apiUrl}/membresias`,this.http=_(A)}obtenerPlanes(){return this.http.get(`${this.apiUrl}/planes`)}obtenerMiMembresia(){return this.http.get(`${this.apiUrl}/mi-membresia`)}suscribirPlan(e,i,l){return this.http.post(`${this.apiUrl}/suscribir`,{tipoPlan:e,metodoPago:i,referenciaPago:l})}cancelarMembresia(){return this.http.post(`${this.apiUrl}/cancelar`,{})}obtenerColorMembresia(e){switch(e){case"premium":return"warning";case"profesional":return"tertiary";default:return"medium"}}obtenerIconoMembresia(e){switch(e){case"premium":return"diamond";case"profesional":return"star";default:return"person"}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var be=(t,o)=>o.key;function Ce(t,o){t&1&&(n(0,"div",2),s(1,"ion-spinner",3),n(2,"p"),c(3,"Cargando planes..."),a()())}function fe(t,o){if(t&1&&c(0),t&2){let e=m(4);b(" ",e.membresiaActual.diasRestantes," d\xEDas restantes ")}}function xe(t,o){t&1&&c(0," Vencida ")}function Me(t,o){if(t&1&&(n(0,"div",16)(1,"div",18),s(2,"ion-icon",19),n(3,"span"),d(4,fe,1,1)(5,xe,1,0),a()(),n(6,"div",18),s(7,"ion-icon",20),n(8,"span"),c(9),a()()()),t&2){let e=m(3);r(4),p(e.membresiaActual.diasRestantes&&e.membresiaActual.diasRestantes>0?4:5),r(5),b("Radio: ",15+e.membresiaActual.radioExtendido," km")}}function Pe(t,o){t&1&&(n(0,"p",17),c(1," Tienes el plan gratuito. \xA1Mejora tu membres\xEDa para obtener m\xE1s clientes! "),a())}function he(t,o){if(t&1&&(n(0,"ion-card",11)(1,"ion-card-header")(2,"div",12),s(3,"ion-icon",13),n(4,"div")(5,"ion-card-title",14),c(6,"Tu Membres\xEDa Actual"),a(),n(7,"ion-badge",15),c(8),a()()()(),n(9,"ion-card-content"),d(10,Me,10,2,"div",16)(11,Pe,2,0,"p",17),a()()),t&2){let e=m(2);P("membresia-"+e.membresiaActual.tipo),r(3),C("name",e.obtenerIcono(e.membresiaActual.tipo)),r(4),C("color",e.obtenerColor(e.membresiaActual.tipo)),r(),b(" ",(e.membresiaActual.planInfo==null?null:e.membresiaActual.planInfo.nombre)||e.membresiaActual.tipo," "),r(2),p(e.membresiaActual.tipo!=="basico"?10:11)}}function Oe(t,o){t&1&&(n(0,"div",22),c(1,"M\xC1S POPULAR"),a())}function ve(t,o){t&1&&(n(0,"span",25),c(1,"Gratis"),a())}function ye(t,o){if(t&1&&(n(0,"span",25),c(1),a(),n(2,"span",30),c(3,"/mes"),a()),t&2){let e=m().$implicit;r(),b("$",e.data.precio,"")}}function Se(t,o){if(t&1&&(n(0,"ion-item"),s(1,"ion-icon",31),n(2,"ion-label"),c(3),a()()),t&2){let e=o.$implicit;r(3),S(e)}}function ke(t,o){t&1&&(n(0,"ion-button",28),s(1,"ion-icon",32),c(2," Plan Actual "),a())}function we(t,o){}function Ie(t,o){t&1&&s(0,"ion-spinner",3)}function Ee(t,o){t&1&&(s(0,"ion-icon",34),c(1," Suscribirse "))}function Te(t,o){if(t&1){let e=v();n(0,"ion-button",33),y("click",function(){x(e);let l=m().$implicit,f=m(2);return M(f.seleccionarPlan(l.key))}),d(1,Ie,1,0,"ion-spinner",3)(2,Ee,2,0),a()}if(t&2){let e=m().$implicit,i=m(2);C("fill",e.key==="premium"?"solid":"outline")("color",e.key==="premium"?"warning":"primary")("disabled",i.procesando),r(),p(i.procesando&&i.planSeleccionado===e.key?1:2)}}function Ae(t,o){if(t&1&&(n(0,"ion-card",21),d(1,Oe,2,0,"div",22),n(2,"ion-card-header")(3,"div",23),s(4,"ion-icon",13),a(),n(5,"ion-card-title"),c(6),a(),n(7,"div",24),d(8,ve,2,0,"span",25)(9,ye,4,1),a()(),n(10,"ion-card-content")(11,"div",26),s(12,"ion-icon",20),n(13,"strong"),c(14),a()(),n(15,"ion-list",27),h(16,Se,4,1,"ion-item",null,E),a(),d(18,ke,3,0,"ion-button",28)(19,we,0,0)(20,Te,3,4,"ion-button",29),a()()),t&2){let e=o.$implicit,i=m(2);P("plan-"+e.key),I("plan-actual",(i.membresiaActual==null?null:i.membresiaActual.tipo)===e.key)("plan-destacado",e.key==="profesional"),r(),p(e.key==="profesional"?1:-1),r(3),C("name",i.obtenerIcono(e.key)),r(2),S(e.data.nombre),r(2),p(e.data.precio===0?8:9),r(6),b("Radio: ",15+e.data.radioExtendido," km"),r(2),O(e.data.beneficios),r(2),p((i.membresiaActual==null?null:i.membresiaActual.tipo)===e.key?18:e.key==="basico"?19:20)}}function Fe(t,o){if(t&1){let e=v();n(0,"div",10)(1,"ion-button",35),y("click",function(){x(e);let l=m(2);return M(l.confirmarCancelacion())}),c(2," Cancelar membres\xEDa "),a()()}}function je(t,o){if(t&1&&(d(0,he,12,6,"ion-card",4),n(1,"div",5)(2,"h2",6),s(3,"ion-icon",7),c(4," Planes Disponibles "),a(),n(5,"div",8),h(6,Ae,21,12,"ion-card",9,be),a()(),d(8,Fe,3,0,"div",10)),t&2){let e=m();p(e.membresiaActual?0:-1),r(6),O(e.planesArray),r(2),p(e.membresiaActual&&e.membresiaActual.tipo!=="basico"?8:-1)}}var We=(()=>{class t{constructor(){this.router=_(F),this.membresiasServicio=_(ue),this.authServicio=_(ee),this.alertCtrl=_(W),this.toastCtrl=_(X),this.cargando=!0,this.procesando=!1,this.planSeleccionado=null,this.planes={},this.planesArray=[],this.membresiaActual=null,te({diamondOutline:oe,starOutline:de,personOutline:ce,checkmarkCircle:ie,closeCircle:ae,rocketOutline:se,shieldCheckmarkOutline:me,locationOutline:re,trophyOutline:_e,ribbonOutline:le,timeOutline:pe,cardOutline:ne})}ngOnInit(){this.cargarDatos()}cargarDatos(){return u(this,null,function*(){this.cargando=!0;try{let e=yield g(this.membresiasServicio.obtenerPlanes());e.exito&&(this.planes=e.datos,this.planesArray=Object.entries(e.datos).map(([l,f])=>({key:l,data:f})));let i=yield g(this.membresiasServicio.obtenerMiMembresia());i.exito&&(this.membresiaActual=i.datos)}catch(e){console.error("Error cargando datos:",e)}finally{this.cargando=!1}})}obtenerIcono(e){switch(e){case"premium":return"diamond-outline";case"profesional":return"star-outline";default:return"person-outline"}}obtenerColor(e){switch(e){case"premium":return"warning";case"profesional":return"tertiary";default:return"medium"}}seleccionarPlan(e){return u(this,null,function*(){let i=this.planes[e];yield(yield this.alertCtrl.create({header:`Suscribirse a ${i.nombre}`,message:`\xBFDeseas suscribirte al plan ${i.nombre} por $${i.precio}/mes?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Pagar con tarjeta",handler:()=>this.procesarPago(e,"tarjeta")}]})).present()})}procesarPago(e,i){return u(this,null,function*(){this.procesando=!0,this.planSeleccionado=e;try{let l=yield g(this.membresiasServicio.suscribirPlan(e,i));l.exito?(yield this.mostrarToast(l.mensaje||"\xA1Suscripci\xF3n exitosa!","success"),yield g(this.authServicio.cargarUsuario()),yield this.cargarDatos()):yield this.mostrarToast(l.mensaje||"Error al procesar pago","danger")}catch(l){yield this.mostrarToast(l.error?.mensaje||"Error al procesar pago","danger")}finally{this.procesando=!1,this.planSeleccionado=null}})}confirmarCancelacion(){return u(this,null,function*(){yield(yield this.alertCtrl.create({header:"Cancelar Membres\xEDa",message:"\xBFEst\xE1s seguro de que deseas cancelar tu membres\xEDa? Perder\xE1s todos los beneficios.",buttons:[{text:"No, mantener",role:"cancel"},{text:"S\xED, cancelar",cssClass:"alert-button-danger",handler:()=>this.cancelarMembresia()}]})).present()})}cancelarMembresia(){return u(this,null,function*(){try{let e=yield g(this.membresiasServicio.cancelarMembresia());e.exito&&(yield this.mostrarToast(e.mensaje,"success"),yield g(this.authServicio.cargarUsuario()),yield this.cargarDatos())}catch(e){yield this.mostrarToast(e.error?.mensaje||"Error al cancelar","danger")}})}mostrarToast(e,i){return u(this,null,function*(){yield(yield this.toastCtrl.create({message:e,duration:3e3,color:i,position:"bottom"})).present()})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-membresias"]],standalone:!0,features:[T],decls:9,vars:1,consts:[["slot","start"],["defaultHref","/tabs/perfil"],[1,"cargando-container"],["name","crescent"],[1,"membresia-actual",3,"class"],[1,"planes-container"],[1,"seccion-titulo"],["name","rocket-outline"],[1,"planes-grid"],[1,"plan-card",3,"plan-actual","plan-destacado","class"],[1,"cancelar-container"],[1,"membresia-actual"],[1,"membresia-header"],[3,"name"],[2,"color","black"],[3,"color"],[1,"info-membresia"],[1,"plan-basico-info"],[1,"info-item"],["name","time-outline"],["name","location-outline"],[1,"plan-card"],[1,"badge-popular"],[1,"plan-icono"],[1,"plan-precio"],[1,"precio"],[1,"plan-radio"],["lines","none",1,"beneficios-lista"],["expand","block","fill","solid","disabled",""],["expand","block",3,"fill","color","disabled"],[1,"periodo"],["name","checkmark-circle","color","success","slot","start"],["name","checkmark-circle","slot","start"],["expand","block",3,"click","fill","color","disabled"],["name","card-outline","slot","start"],["fill","clear","color","danger",3,"click"]],template:function(i,l){i&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s(3,"ion-back-button",1),a(),n(4,"ion-title"),c(5,"Membres\xEDas"),a()()(),n(6,"ion-content"),d(7,Ce,4,0,"div",2)(8,je,9,2),a()),i&2&&(r(7),p(l.cargando?7:8))},dependencies:[H,L,Q,K,z,j,U,V,R,B,D,Y,$,J,G,N,q],styles:[".cargando-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh}.cargando-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:48px;height:48px}.cargando-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:var(--ion-color-medium)}.membresia-actual[_ngcontent-%COMP%]{margin:16px;border-radius:16px;overflow:hidden}.membresia-actual.membresia-premium[_ngcontent-%COMP%]{background:linear-gradient(135deg,gold,orange);color:#333}.membresia-actual.membresia-profesional[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed,#5b21b6);color:#fff}.membresia-actual.membresia-profesional[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .membresia-actual.membresia-profesional[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{color:#fff}.membresia-actual.membresia-basico[_ngcontent-%COMP%]{background:var(--ion-color-light)}.membresia-actual[_ngcontent-%COMP%]   .membresia-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.membresia-actual[_ngcontent-%COMP%]   .membresia-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.membresia-actual[_ngcontent-%COMP%]   .info-membresia[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:8px}.membresia-actual[_ngcontent-%COMP%]   .info-membresia[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.membresia-actual[_ngcontent-%COMP%]   .info-membresia[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.membresia-actual[_ngcontent-%COMP%]   .plan-basico-info[_ngcontent-%COMP%]{margin:0;font-size:14px}.seccion-titulo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;margin:0;font-size:18px;font-weight:600}.seccion-titulo[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-primary)}.planes-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:0 16px}.plan-card[_ngcontent-%COMP%]{border-radius:16px;position:relative;overflow:hidden}.plan-card.plan-destacado[_ngcontent-%COMP%]{border:2px solid var(--ion-color-primary)}.plan-card.plan-actual[_ngcontent-%COMP%]{opacity:.7}.plan-card[_ngcontent-%COMP%]   .badge-popular[_ngcontent-%COMP%]{position:absolute;top:12px;right:-30px;background:var(--ion-color-primary);color:#fff;padding:4px 40px;font-size:10px;font-weight:700;transform:rotate(45deg)}.plan-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{text-align:center;padding-bottom:8px}.plan-card[_ngcontent-%COMP%]   .plan-icono[_ngcontent-%COMP%]{width:60px;height:60px;margin:0 auto 12px;border-radius:50%;display:flex;align-items:center;justify-content:center}.plan-card[_ngcontent-%COMP%]   .plan-icono[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.plan-card.plan-basico[_ngcontent-%COMP%]   .plan-icono[_ngcontent-%COMP%]{background:var(--ion-color-medium-tint);color:var(--ion-color-medium)}.plan-card.plan-profesional[_ngcontent-%COMP%]   .plan-icono[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed,#5b21b6);color:#fff}.plan-card.plan-premium[_ngcontent-%COMP%]   .plan-icono[_ngcontent-%COMP%]{background:linear-gradient(135deg,gold,orange);color:#333}.plan-card[_ngcontent-%COMP%]   .plan-precio[_ngcontent-%COMP%]{margin-top:8px}.plan-card[_ngcontent-%COMP%]   .plan-precio[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]{font-size:32px;font-weight:700}.plan-card[_ngcontent-%COMP%]   .plan-precio[_ngcontent-%COMP%]   .periodo[_ngcontent-%COMP%]{font-size:14px;color:var(--ion-color-medium)}.plan-card[_ngcontent-%COMP%]   .plan-radio[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px;background:var(--ion-color-light);border-radius:8px;margin-bottom:16px}.plan-card[_ngcontent-%COMP%]   .plan-radio[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.plan-card[_ngcontent-%COMP%]   .beneficios-lista[_ngcontent-%COMP%]{padding:0;margin-bottom:16px}.plan-card[_ngcontent-%COMP%]   .beneficios-lista[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--min-height: 36px;font-size:14px}.plan-card[_ngcontent-%COMP%]   .beneficios-lista[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.cancelar-container[_ngcontent-%COMP%]{text-align:center;padding:24px}"]})}}return t})();export{We as MembresiasPage};
