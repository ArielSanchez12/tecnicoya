import{a as de}from"./chunk-L2HDJ5P4.js";import{Aa as le,Da as ce,a as oe,ka as re,n as ae,za as se}from"./chunk-TI2PQS3J.js";import{a as ie}from"./chunk-XRERQNEZ.js";import"./chunk-JQ3F7U5Y.js";import{A as C,Aa as N,B as i,C as o,D as c,Ea as A,F as x,Fa as k,G as d,Ha as D,Ia as H,Ja as L,K as r,L as p,M,O as I,Oa as W,P as R,Q as y,R as T,S as F,Sa as Q,T as E,V as U,Ya as q,Z as j,Za as G,_a as J,ab as K,bb as V,cb as X,eb as Y,ia as z,ib as Z,j as g,jb as ee,k as v,n as O,o as a,oa as B,qa as $,r as f,s as _,sb as ne,vb as te,w as u,wa as w,y as S,z as h}from"./chunk-IBAPA63D.js";import"./chunk-XMAMLXFW.js";import"./chunk-EW67HA6M.js";import"./chunk-WXVXXLBH.js";import"./chunk-EFAAWUSX.js";import"./chunk-GLOUZK3F.js";import"./chunk-N4PXAYQ7.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-NMPY7VJP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as P}from"./chunk-B4AJQJMI.js";var me=(n,l)=>l._id,pe=()=>[1,2,3,4,5];function ge(n,l){n&1&&(i(0,"div",6),c(1,"ion-spinner",8),i(2,"p"),r(3,"Cargando rese\xF1as..."),o()())}function fe(n,l){if(n&1&&(i(0,"div",7),c(1,"ion-icon",9),i(2,"h3"),r(3,"Sin rese\xF1as"),o(),i(4,"p"),r(5),o()()),n&2){let e=d();a(5),p(e.esTecnico?"A\xFAn no has recibido rese\xF1as":"A\xFAn no has dado ninguna rese\xF1a")}}function ue(n,l){if(n&1&&c(0,"ion-icon",14),n&2){let e=l.$implicit,t=d().$implicit;_("name",e<=t.calificacion?"star":"star-outline")("color",e<=t.calificacion?"warning":"medium")}}function _e(n,l){if(n&1&&(i(0,"ion-badge",16),r(1),o()),n&2){let e=d().$implicit;a(),M(" ",(e.trabajo==null||e.trabajo.servicio==null?null:e.trabajo.servicio.titulo)||(e.infoTrabajo==null?null:e.infoTrabajo.tipoServicio)," ")}}function he(n,l){if(n&1&&(i(0,"div",18),c(1,"ion-icon",19),i(2,"div")(3,"strong"),r(4,"Respuesta:"),o(),i(5,"p"),r(6),o()()()),n&2){let e=d().$implicit;a(6),p(e.respuesta.contenido)}}function Ce(n,l){if(n&1&&(i(0,"ion-card")(1,"ion-card-content")(2,"div",10)(3,"ion-avatar"),c(4,"img",11),o(),i(5,"div",12)(6,"h3"),r(7),o(),i(8,"div",13),h(9,ue,1,2,"ion-icon",14,S),o(),i(11,"ion-note"),c(12,"ion-icon",15),r(13),E(14,"date"),o()()(),f(15,_e,2,1,"ion-badge",16),i(16,"p",17),r(17),o(),f(18,he,7,1,"div",18),o()()),n&2){let e=l.$implicit,t=d(2);a(4),_("src",t.obtenerFotoUsuario(e),O),a(3),p(t.obtenerNombreUsuario(e)),a(2),C(F(9,pe)),a(4),M(" ",U(14,6,e.fechaCreacion,"dd/MM/yyyy")," "),a(2),u(!(e.trabajo==null||e.trabajo.servicio==null)&&e.trabajo.servicio.titulo||e.infoTrabajo!=null&&e.infoTrabajo.tipoServicio?15:-1),a(2),p(e.comentario),a(),u(e.respuesta!=null&&e.respuesta.contenido?18:-1)}}function xe(n,l){if(n&1&&(i(0,"ion-list"),h(1,Ce,19,10,"ion-card",null,me),o()),n&2){let e=d();a(),C(e.resenas)}}var we=(()=>{class n{constructor(){this.router=g(z),this.authServicio=g(ie),this.resenasServicio=g(de),this.resenas=[],this.cargando=!0,this.filtro="recibidas",oe({starOutline:le,star:se,personOutline:re,timeOutline:ce,chatbubbleOutline:ae})}get esTecnico(){return this.authServicio.esTecnico()}ngOnInit(){this.cargarResenas()}cargarResenas(){this.cargando=!0;let e=this.authServicio.obtenerUsuario();if(!e){this.cargando=!1;return}this.filtro==="recibidas"?this.esTecnico?this.resenasServicio.obtenerResenasTecnico(e._id).subscribe({next:t=>{this.resenas=t.datos?.resenas||t.datos||[],this.cargando=!1},error:()=>{this.resenas=[],this.cargando=!1}}):this.resenasServicio.obtenerMisResenas("recibidas").subscribe({next:t=>{this.resenas=t.datos?.resenas||t.datos||[],this.cargando=!1},error:()=>{this.resenas=[],this.cargando=!1}}):this.resenasServicio.obtenerMisResenas("enviadas").subscribe({next:t=>{this.resenas=t.datos?.resenas||t.datos||[],this.cargando=!1},error:()=>{this.resenas=[],this.cargando=!1}})}refrescar(e){return P(this,null,function*(){this.cargarResenas(),setTimeout(()=>e.target.complete(),1e3)})}obtenerFotoUsuario(e){return this.filtro==="recibidas"?e.idResenador?.perfil?.fotoUrl||e.cliente?.perfil?.fotoUrl||e.tecnico?.perfil?.fotoUrl||"assets/avatar-default.png":e.idResenado?.perfil?.fotoUrl||e.tecnico?.perfil?.fotoUrl||e.cliente?.perfil?.fotoUrl||"assets/avatar-default.png"}obtenerNombreUsuario(e){if(this.filtro==="recibidas"){let s=e.idResenador?.perfil||e.cliente?.perfil||e.tecnico?.perfil;return s?`${s.nombre} ${s.apellido}`:"Usuario"}let t=e.idResenado?.perfil||e.tecnico?.perfil||e.cliente?.perfil;return t?`${t.nombre} ${t.apellido}`:"Usuario"}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=v({type:n,selectors:[["app-mis-resenas"]],standalone:!0,features:[T],decls:19,vars:2,consts:[["slot","start"],["defaultHref","/tabs/perfil"],["slot","fixed",3,"ionRefresh"],[3,"ngModelChange","ionChange","ngModel"],["value","recibidas"],["value","dadas"],[1,"loading-container"],[1,"empty-container"],["name","crescent"],["name","star-outline"],[1,"resena-header"],["alt","Foto",3,"src"],[1,"resena-info"],[1,"estrellas"],[3,"name","color"],["name","time-outline"],["color","light",1,"servicio-badge"],[1,"comentario"],[1,"respuesta"],["name","chatbubble-outline"]],template:function(t,s){t&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),c(3,"ion-back-button",1),o(),i(4,"ion-title"),r(5,"Mis Rese\xF1as"),o()()(),i(6,"ion-content")(7,"ion-refresher",2),x("ionRefresh",function(m){return s.refrescar(m)}),c(8,"ion-refresher-content"),o(),i(9,"ion-segment",3),y("ngModelChange",function(m){return R(s.filtro,m)||(s.filtro=m),m}),x("ionChange",function(){return s.cargarResenas()}),i(10,"ion-segment-button",4)(11,"ion-label"),r(12,"Recibidas"),o()(),i(13,"ion-segment-button",5)(14,"ion-label"),r(15,"Que he dado"),o()()(),f(16,ge,4,0,"div",6)(17,fe,6,1,"div",7)(18,xe,3,0,"ion-list"),o()),t&2&&(a(9),I("ngModel",s.filtro),a(7),u(s.cargando?16:s.resenas.length===0?17:18))},dependencies:[W,Q,ee,Z,D,N,H,L,A,G,q,Y,K,V,te,X,ne,J,k,j,w,B,$],styles:[".loading-container[_ngcontent-%COMP%], .empty-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh;color:var(--ion-color-medium)}.loading-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .empty-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.loading-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .empty-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:8px 0;color:var(--ion-text-color)}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;padding:0 32px}ion-card[_ngcontent-%COMP%]{margin:12px 16px;border-radius:12px}.resena-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:12px}.resena-header[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:48px;height:48px}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]{flex:1}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;font-weight:600}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]   .estrellas[_ngcontent-%COMP%]{display:flex;gap:2px;margin-bottom:4px}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]   .estrellas[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px}.resena-header[_ngcontent-%COMP%]   .resena-info[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.servicio-badge[_ngcontent-%COMP%]{margin-bottom:8px;font-size:11px}.comentario[_ngcontent-%COMP%]{margin:12px 0;line-height:1.5}.respuesta[_ngcontent-%COMP%]{display:flex;gap:8px;padding:12px;background:var(--ion-color-light);border-radius:8px;margin-top:12px}.respuesta[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-primary)}.respuesta[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px}ion-segment[_ngcontent-%COMP%]{margin:16px}"]})}}return n})();export{we as MisResenasPage};
