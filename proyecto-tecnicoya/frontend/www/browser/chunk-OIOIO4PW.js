import{a as Se}from"./chunk-2WRDL5NI.js";import{a as he,b as Ce}from"./chunk-WXOXMQ3X.js";import{D as fe,Da as xe,R as ue,_ as _e,a as se,c as ce,d as le,e as de,h as me,p as pe,s as ge,v as ve}from"./chunk-TI2PQS3J.js";import"./chunk-JQ3F7U5Y.js";import{A as b,Aa as D,B as i,C as t,D as c,E as I,F as f,Fa as H,G as m,Ha as L,Ia as W,Ja as $,K as o,Ka as G,L as p,M as x,Ma as U,N as y,Na as J,O as T,Oa as K,P as F,Q as z,R as w,Sa as Q,T as h,V as k,W as B,Ya as X,Z as R,Za as Y,aa as j,ab as Z,bb as ee,cb as ie,eb as te,ia as q,ib as ne,j as u,jb as oe,k as S,l as M,m as P,o as r,oa as N,qa as A,r as _,s as E,sb as re,vb as ae,w as v,wa as V,z as O}from"./chunk-IBAPA63D.js";import"./chunk-XMAMLXFW.js";import"./chunk-EW67HA6M.js";import"./chunk-WXVXXLBH.js";import"./chunk-EFAAWUSX.js";import"./chunk-GLOUZK3F.js";import"./chunk-N4PXAYQ7.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-NMPY7VJP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as C}from"./chunk-B4AJQJMI.js";var Me=(n,l)=>l._id;function Pe(n,l){n&1&&(i(0,"div",8),c(1,"ion-spinner"),i(2,"p"),o(3,"Cargando servicios..."),t()())}function Ee(n,l){n&1&&(i(0,"div",9),c(1,"ion-icon",11),i(2,"h3"),o(3,"No tienes servicios"),t(),i(4,"p"),o(5,"Crea tu primera solicitud de servicio para comenzar"),t()())}function Oe(n,l){n&1&&(i(0,"ion-badge",22),c(1,"ion-icon",24),o(2," URGENTE "),t())}function be(n,l){if(n&1&&(i(0,"div",23),c(1,"ion-icon",25),i(2,"span"),o(3),t(),c(4,"ion-icon",26),t()),n&2){let e=m().$implicit;r(3),x("",e.cotizaciones.length," cotizaci\xF3n(es) recibida(s)")}}function Ie(n,l){if(n&1){let e=I();i(0,"ion-card",13),f("click",function(){let a=M(e).$implicit,g=m(2);return P(g.verServicio(a._id))}),i(1,"ion-card-header")(2,"div",14)(3,"ion-card-title"),o(4),t(),i(5,"ion-badge",15),o(6),t()(),i(7,"ion-chip",16)(8,"ion-label"),o(9),t()()(),i(10,"ion-card-content")(11,"p",17),o(12),h(13,"slice"),t(),i(14,"div",18)(15,"div",19),c(16,"ion-icon",20),i(17,"span"),o(18),t()(),i(19,"div",19),c(20,"ion-icon",21),i(21,"span"),o(22),h(23,"date"),t()()(),_(24,Oe,3,0,"ion-badge",22)(25,be,5,1,"div",23),t()()}if(n&2){let e=l.$implicit,s=m(2);r(4),p(e.titulo),r(),E("color",s.obtenerColorEstado(e.estado)),r(),x(" ",s.obtenerEtiquetaEstado(e.estado)," "),r(3),p(s.obtenerEtiquetaTipo(e.tipo)),r(3),y("",B(13,10,e.descripcion||"",0,80),"",(e.descripcion==null?null:e.descripcion.length)>80?"...":"",""),r(6),p((e.ubicacion==null?null:e.ubicacion.direccion)||"Sin ubicaci\xF3n"),r(4),p(k(23,14,e.fechaCreacion,"dd/MM/yyyy")),r(2),v(e.urgencia==="emergencia"?24:-1),r(),v(e.estado==="pendiente"&&e.cotizaciones&&e.cotizaciones.length>0?25:-1)}}function ye(n,l){if(n&1&&(i(0,"ion-list",10),O(1,Ie,26,17,"ion-card",12,Me),t()),n&2){let e=m();r(),b(e.serviciosFiltrados)}}var $e=(()=>{class n{constructor(){this.router=u(q),this.serviciosServicio=u(Se),this.servicios=[],this.serviciosFiltrados=[],this.filtroEstado="todos",this.cargando=!1,se({addOutline:ce,locationOutline:_e,timeOutline:xe,chevronForward:ge,calendarOutline:me,alertCircleOutline:le,checkmarkCircleOutline:pe,hourglassOutline:ue,closeCircleOutline:ve,briefcaseOutline:de,documentTextOutline:fe})}ngOnInit(){this.cargarServicios()}cargarServicios(){this.cargando=!0,this.serviciosServicio.obtenerMisServicios().subscribe({next:e=>{this.cargando=!1,e.datos?.servicios?this.servicios=e.datos.servicios:Array.isArray(e.datos)?this.servicios=e.datos:this.servicios=[],this.filtrar()},error:()=>{this.cargando=!1,this.servicios=[],this.serviciosFiltrados=[]}})}filtrar(){Array.isArray(this.servicios)||(this.servicios=[]),this.filtroEstado==="todos"?this.serviciosFiltrados=this.servicios:this.filtroEstado==="en_progreso"?this.serviciosFiltrados=this.servicios.filter(e=>e.estado==="aceptado"||e.estado==="en_progreso"):this.filtroEstado==="pendiente"?this.serviciosFiltrados=this.servicios.filter(e=>e.estado==="pendiente"||e.estado==="cotizado"):this.serviciosFiltrados=this.servicios.filter(e=>e.estado===this.filtroEstado)}refrescar(e){return C(this,null,function*(){yield this.cargarServicios(),e.target.complete()})}nuevoServicio(){this.router.navigate(["/nuevo-servicio"])}verServicio(e){this.router.navigate(["/servicio",e])}obtenerColorEstado(e){return{pendiente:"warning",cotizado:"tertiary",en_progreso:"primary",completado:"success",cancelado:"danger"}[e]||"medium"}obtenerEtiquetaEstado(e){return Ce.find(a=>a.valor===e)?.etiqueta||e}obtenerEtiquetaTipo(e){return he.find(a=>a.valor===e)?.etiqueta||e}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=S({type:n,selectors:[["app-mis-servicios"]],standalone:!0,features:[w],decls:25,vars:2,consts:[["slot","start"],["defaultHref","/tabs/perfil","text",""],["slot","fixed",3,"ionRefresh"],[3,"ngModelChange","ionChange","ngModel"],["value","todos"],["value","pendiente"],["value","en_progreso"],["value","completado"],[1,"loading-container"],[1,"empty-state","ion-padding","ion-text-center"],[1,"lista-servicios"],["name","briefcase-outline","color","medium"],[1,"tarjeta-servicio"],[1,"tarjeta-servicio",3,"click"],[1,"servicio-header"],[3,"color"],["size","small",1,"chip-tipo"],[1,"descripcion"],[1,"servicio-info"],[1,"info-item"],["name","location-outline"],["name","calendar-outline"],["color","danger",1,"badge-urgencia"],[1,"cotizaciones-info"],["name","alert-circle-outline"],["name","document-text-outline"],["name","chevron-forward",1,"icon-forward"]],template:function(s,a){s&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),c(3,"ion-back-button",1),t(),i(4,"ion-title"),o(5,"Mis Servicios"),t()()(),i(6,"ion-content")(7,"ion-refresher",2),f("ionRefresh",function(d){return a.refrescar(d)}),c(8,"ion-refresher-content"),t(),i(9,"ion-segment",3),z("ngModelChange",function(d){return F(a.filtroEstado,d)||(a.filtroEstado=d),d}),f("ionChange",function(){return a.filtrar()}),i(10,"ion-segment-button",4)(11,"ion-label"),o(12,"Todos"),t()(),i(13,"ion-segment-button",5)(14,"ion-label"),o(15,"Pendientes"),t()(),i(16,"ion-segment-button",6)(17,"ion-label"),o(18,"En Progreso"),t()(),i(19,"ion-segment-button",7)(20,"ion-label"),o(21,"Completados"),t()()(),_(22,Pe,4,0,"div",8)(23,Ee,6,0,"div",9)(24,ye,3,0,"ion-list",10),t()),s&2&&(r(9),T("ngModel",a.filtroEstado),r(13),v(a.cargando?22:a.serviciosFiltrados.length===0?23:24))},dependencies:[K,Q,oe,ne,re,W,$,G,U,H,Y,X,te,Z,ee,ae,ie,J,L,D,R,j,V,N,A],styles:["ion-segment[_ngcontent-%COMP%]{padding:8px 16px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px 16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]{padding:64px 32px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:80px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px;color:var(--ion-text-color)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:24px}.lista-servicios[_ngcontent-%COMP%]{padding:8px 16px}.tarjeta-servicio[_ngcontent-%COMP%]{margin:0 0 16px;border-radius:12px;cursor:pointer}.tarjeta-servicio[_ngcontent-%COMP%]:active{transform:scale(.98)}.servicio-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:8px}.servicio-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:16px;flex:1}.chip-tipo[_ngcontent-%COMP%]{margin:8px 0 0;height:24px}.descripcion[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:14px;margin:0 0 16px}.servicio-info[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:12px}.servicio-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:13px;color:var(--ion-color-medium)}.servicio-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.badge-urgencia[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;margin-bottom:8px}.cotizaciones-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background:var(--ion-color-primary-tint);border-radius:8px;margin-top:8px;color:var(--ion-color-primary);font-size:14px;font-weight:500}.cotizaciones-info[_ngcontent-%COMP%]   .icon-forward[_ngcontent-%COMP%]{margin-left:auto}"]})}}return n})();export{$e as MisServiciosPage};
