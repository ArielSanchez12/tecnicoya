import{H as J,I as K,a as U,aa as Q,ba as W,da as X}from"./chunk-TI2PQS3J.js";import{a as V}from"./chunk-XRERQNEZ.js";import"./chunk-JQ3F7U5Y.js";import{Aa as k,B as e,C as i,D as s,F as g,Ga as w,Ha as M,K as a,Oa as F,R as v,Sa as T,Ta as L,Ua as N,Za as B,eb as R,hb as j,ia as C,ib as A,j as c,jb as D,k as b,na as p,o as m,oa as x,ob as G,pa as S,qb as z,r as u,ra as I,s as h,sa as P,sb as q,ta as y,tb as H,va as E,w as d,xa as O}from"./chunk-IBAPA63D.js";import"./chunk-XMAMLXFW.js";import"./chunk-EW67HA6M.js";import"./chunk-WXVXXLBH.js";import"./chunk-EFAAWUSX.js";import"./chunk-GLOUZK3F.js";import"./chunk-N4PXAYQ7.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-NMPY7VJP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as l}from"./chunk-B4AJQJMI.js";function Y(o,f){o&1&&(e(0,"p",11),a(1,"Ingresa un correo v\xE1lido"),i())}function Z(o,f){o&1&&(e(0,"p",11),a(1,"La contrase\xF1a es obligatoria"),i())}function $(o,f){o&1&&s(0,"ion-spinner",16)}function ee(o,f){o&1&&a(0," Iniciar Sesi\xF3n ")}var ue=(()=>{class o{constructor(){this.fb=c(E),this.authServicio=c(V),this.router=c(C),this.toastCtrl=c(z),this.alertCtrl=c(G),this.cargando=!1,U({mailOutline:X,lockClosedOutline:Q,eyeOutline:K,eyeOffOutline:J,logInOutline:W}),this.formulario=this.fb.group({email:["",[p.required,p.email]],contrasena:["",[p.required]]})}campoInvalido(r){let n=this.formulario.get(r);return n?n.invalid&&n.touched:!1}iniciarSesion(){return l(this,null,function*(){if(!this.formulario.invalid){this.cargando=!0;try{let{email:r,contrasena:n}=this.formulario.value;this.authServicio.login({email:r,contrasena:n}).subscribe({next:t=>l(this,null,function*(){this.cargando=!1,t.exito?(console.log("\u2705 Login exitoso, navegando a /tabs/inicio"),this.router.navigate(["/tabs/inicio"],{replaceUrl:!0})):yield this.mostrarError(t.mensaje||"Error al iniciar sesi\xF3n")}),error:t=>l(this,null,function*(){this.cargando=!1,yield this.mostrarError(t.error?.mensaje||"Error de conexi\xF3n. Int\xE9ntalo de nuevo.")})})}catch{this.cargando=!1,yield this.mostrarError("Error inesperado")}}})}recuperarContrasena(){return l(this,null,function*(){yield(yield this.alertCtrl.create({header:"Recuperar contrase\xF1a",message:"Ingresa tu correo electr\xF3nico y te enviaremos instrucciones.",inputs:[{name:"email",type:"email",placeholder:"tu@email.com"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Enviar",handler:n=>l(this,null,function*(){n.email&&(yield(yield this.toastCtrl.create({message:"Si el correo existe, recibir\xE1s instrucciones.",duration:3e3,position:"bottom",color:"success"})).present())})}]})).present()})}irARegistro(){this.router.navigate(["/registro"])}mostrarError(r){return l(this,null,function*(){yield(yield this.toastCtrl.create({message:r,duration:3e3,position:"bottom",color:"danger"})).present()})}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=b({type:o,selectors:[["app-login"]],standalone:!0,features:[v],decls:35,vars:5,consts:[["slot","start"],["defaultHref","/bienvenida"],[1,"ion-padding"],[1,"login-container"],[1,"logo-section"],[1,"logo-circle"],["name","log-in-outline"],[3,"ngSubmit","formGroup"],[1,"formulario-registro"],["name","mail-outline","slot","start","color","medium"],["formControlName","email","type","email","label","Correo electr\xF3nico","labelPlacement","floating","placeholder","tu@email.com"],[1,"error-validacion"],["name","lock-closed-outline","slot","start","color","medium"],["formControlName","contrasena","type","password","label","Contrase\xF1a","labelPlacement","floating","placeholder","Tu contrase\xF1a"],["slot","end"],["expand","block","type","submit",1,"boton-submit",3,"disabled"],["name","crescent"],[1,"links-adicionales"],["fill","clear","size","small",3,"click"],["color","primary",3,"click"]],template:function(n,t){n&1&&(e(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s(3,"ion-back-button",1),i(),e(4,"ion-title"),a(5,"Iniciar Sesi\xF3n"),i()()(),e(6,"ion-content",2)(7,"div",3)(8,"div",4)(9,"div",5),s(10,"ion-icon",6),i(),e(11,"h2"),a(12,"Bienvenido de vuelta"),i()(),e(13,"form",7),g("ngSubmit",function(){return t.iniciarSesion()}),e(14,"ion-list",8)(15,"ion-item"),s(16,"ion-icon",9)(17,"ion-input",10),i(),u(18,Y,2,0,"p",11),e(19,"ion-item"),s(20,"ion-icon",12),e(21,"ion-input",13),s(22,"ion-input-password-toggle",14),i()(),u(23,Z,2,0,"p",11),i(),e(24,"ion-button",15),u(25,$,1,0,"ion-spinner",16)(26,ee,1,0),i()(),e(27,"div",17)(28,"ion-button",18),g("click",function(){return t.recuperarContrasena()}),a(29," \xBFOlvidaste tu contrase\xF1a? "),i(),e(30,"p"),a(31," \xBFNo tienes cuenta? "),e(32,"ion-text",19),g("click",function(){return t.irARegistro()}),e(33,"strong"),a(34,"Reg\xEDstrate"),i()()()()()()),n&2&&(m(13),h("formGroup",t.formulario),m(5),d(t.campoInvalido("email")?18:-1),m(5),d(t.campoInvalido("contrasena")?23:-1),m(),h("disabled",t.formulario.invalid||t.cargando),m(),d(t.cargando?25:26))},dependencies:[F,T,D,A,k,M,w,q,H,N,B,j,R,L,O,I,x,S,P,y],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding-top:24px}.logo-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.logo-circle[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;margin:0 auto 16px}.logo-circle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px;color:#fff}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#fff;margin:0}.boton-submit[_ngcontent-%COMP%]{margin-top:24px;--border-radius: 12px;height:50px}.links-adicionales[_ngcontent-%COMP%]{text-align:center;margin-top:24px}.links-adicionales[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.links-adicionales[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{cursor:pointer}"]})}}return o})();export{ue as LoginPage};
